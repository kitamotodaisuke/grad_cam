# TensorFlow Lite 推論 & Grad-CAM 可視化アプリ

TypeScript + Reactで構築された、ブラウザ上でTensorFlow Liteモデルを実行し、Grad-CAM風の可視化を行うWebアプリケーションです。

## ✨ 主な機能

- 🤖 **TFLiteモデルのアップロード**: ブラウザで直接.tfliteファイルを読み込み
- 🖼️ **画像のドラッグ&ドロップ**: 直感的な画像アップロード機能
- ⚡ **リアルタイム推論**: ブラウザ内でのモデル推論実行
- 🎯 **Grad-CAM可視化**: モデルが注目している部分をヒートマップで表示
- 📊 **推論結果表示**: 信頼度とともに予測結果を視覚的に表示
- 📱 **レスポンシブデザイン**: モバイル・デスクトップ対応

## 🛠️ 技術スタック

- **Frontend**: React 18 + TypeScript
- **Build Tool**: Vite
- **AI/ML**: TensorFlow.js + TensorFlow Lite
- **Styling**: CSS3 (グラデーション、アニメーション)

## 🚀 クイックスタート

### 前提条件

- Node.js (推奨: v16以上)
- npm または yarn

### インストール

```bash
# 依存関係をインストール
npm install

# 開発サーバーを起動
npm run dev
```

ブラウザで `http://localhost:5173` にアクセスしてください。

### プロダクションビルド

```bash
npm run build
npm run preview
```

## 📖 使用方法

### 1. TFLiteモデルのアップロード
- `.tflite` 形式のモデルファイルをアップロード
- モデルが正常に読み込まれると成功メッセージが表示されます

### 2. 画像のアップロード
- 推論したい画像をドラッグ&ドロップまたはクリックして選択
- 対応形式: JPEG, PNG, WebP等の一般的な画像形式

### 3. 推論実行
- 「推論実行」ボタンをクリック
- モデルによる予測結果が信頼度とともに表示されます

### 4. 可視化の確認
- Grad-CAM風のヒートマップでモデルの注目領域を確認
- 赤い部分ほどモデルが重要視している領域です

## 🏗️ プロジェクト構造

```
web_apps/
├── src/
│   ├── App.tsx          # メインアプリケーションコンポーネント
│   ├── App.css          # UIスタイリング
│   └── main.tsx         # エントリーポイント
├── public/              # 静的ファイル
├── package.json         # 依存関係とスクリプト
└── vite.config.ts       # Vite設定
```

## ⚙️ 主要なコンポーネント機能

### モデル管理
- TensorFlow Lite モデルの動的読み込み
- モデル状態管理（読み込み中、成功、エラー）
- メモリ効率的なモデル使用

### 画像処理
- ブラウザ上での画像前処理
- テンソル変換（リサイズ、正規化）
- Canvas APIを使用した画像表示

### 推論エンジン
- ブラウザ内推論実行
- バッチ処理対応
- エラーハンドリング

### 可視化
- Grad-CAM風ヒートマップ生成
- カラーマップ適用（青→緑→黄→赤）
- 半透明オーバーレイ表示

## 🎨 UI/UX 特徴

- **モダンデザイン**: グラデーション、シャドウ、アニメーション
- **直感的操作**: ドラッグ&ドロップ、ワンクリック推論
- **視覚的フィードバック**: ローディングアニメーション、進捗表示
- **レスポンシブ**: モバイルファーストデザイン

## 🔧 カスタマイズ

### モデル入力サイズの変更
```typescript
// App.tsx の preprocessImage 関数内
tensor = tf.image.resizeBilinear(tensor, [224, 224]) // サイズを変更
```

### 可視化の色設定
```typescript
// generateGradCAM 関数内でカラーマップを調整
const r = tf.clipByValue(normalized.mul(2).sub(1), 0, 1)
const g = tf.clipByValue(normalized.mul(2), 0, 1)
const b = tf.clipByValue(tf.sub(1, normalized.mul(2)), 0, 1)
```

## 🐛 トラブルシューティング

### モデル読み込みエラー
- ファイル形式が`.tflite`であることを確認
- モデルサイズが大きすぎる場合はブラウザのメモリ制限に注意

### 推論エラー
- 画像の前処理設定がモデルの期待する入力形式と一致しているか確認
- コンソールでエラーメッセージを確認

### パフォーマンス問題
- 大きな画像は自動的にリサイズされます
- メモリ使用量を監視し、必要に応じてモデルを最適化

## 📝 今後の改善予定

- [ ] 複数モデルの同時読み込み対応
- [ ] 詳細なGrad-CAM実装（勾配計算）
- [ ] モデルメタデータの自動抽出
- [ ] バッチ推論対応
- [ ] PWA対応

## 🤝 コントリビューション

プルリクエストやイシューの報告を歓迎します。大きな変更を行う前に、まずイシューを作成して議論してください。

## 📄 ライセンス

MIT License

## 🙋‍♂️ サポート

質問や問題がある場合は、GitHubのIssuesでお知らせください。
